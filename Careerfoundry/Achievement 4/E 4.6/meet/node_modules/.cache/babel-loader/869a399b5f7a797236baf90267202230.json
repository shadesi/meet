{"ast":null,"code":"//src/api.js\n\nimport mockData from \"./mock-data\";\nexport const extractLocations = events => {\n  const extractedLocations = events.map(event => event.location);\n  const locations = [...new Set(extractedLocations)];\n  return locations;\n};\nexport const getAccessToken = async () => {\n  const accessToken = localStorage.getItem('access_token');\n  const tokenCheck = accessToken && (await checkToken(accessToken));\n  if (!accessToken || tokenCheck.error) {\n    await localStorage.removeItem(\"access_token\");\n    const searchParams = new URLSearchParams(window.location.search);\n    const code = searchParams.get(\"code\");\n    if (!code) {\n      const response = await fetch(\"YOUR_SERVERLESS_GET_AUTH_URL_ENDPOINT\");\n      const result = await response.json();\n      const {\n        authUrl\n      } = result;\n      window.location.href = authUrl;\n    } else {\n      return await getToken(code);\n    }\n  }\n  return accessToken;\n};\nconst checkToken = async accessToken => {\n  const response = await fetch(`https://www.googleapis.com/oauth2/v1/tokeninfo?access_token=${accessToken}`);\n  return await response.json();\n};\nexport const getEvents = async () => {\n  if (window.location.href.startsWith(\"http://localhost\")) {\n    return mockData;\n  }\n  const token = await getAccessToken();\n  if (token) {\n    removeQuery();\n    const url = `YOUR_GET_EVENTS_API_ENDPOINT/${token}`;\n    const response = await fetch(url);\n    const result = await response.json();\n    return result.events || null;\n  }\n};\nconst removeQuery = () => {\n  let newurl;\n  if (window.history.pushState && window.location.pathname) {\n    newurl = `${window.location.protocol}//${window.location.host}${window.location.pathname}`;\n    window.history.pushState(\"\", \"\", newurl);\n  } else {\n    newurl = `${window.location.protocol}//${window.location.host}`;\n    window.history.pushState(\"\", \"\", newurl);\n  }\n};\nconst getToken = async code => {\n  const encodeCode = encodeURIComponent(code);\n  const response = await fetch(`YOUR_GET_ACCESS_TOKEN_ENDPOINT/${encodeCode}`);\n  const {\n    access_token\n  } = await response.json();\n  if (access_token) {\n    localStorage.setItem(\"access_token\", access_token);\n  }\n  return access_token;\n};","map":{"version":3,"names":["mockData","extractLocations","events","extractedLocations","map","event","location","locations","Set","getAccessToken","accessToken","localStorage","getItem","tokenCheck","checkToken","error","removeItem","searchParams","URLSearchParams","window","search","code","get","response","fetch","result","json","authUrl","href","getToken","getEvents","startsWith","token","removeQuery","url","newurl","history","pushState","pathname","protocol","host","encodeCode","encodeURIComponent","access_token","setItem"],"sources":["/Users/shanedesilva/Desktop/Careerfoundry/Achievement 4/E 4.5/meet/src/api.js"],"sourcesContent":["//src/api.js\n\nimport mockData from \"./mock-data\";\n\nexport const extractLocations = (events) => {\n  const extractedLocations = events.map((event) => event.location);\n  const locations = [...new Set(extractedLocations)];\n  return locations;\n};\n\nexport const getAccessToken = async () => {\n  const accessToken = localStorage.getItem('access_token');\n  const tokenCheck = accessToken && (await checkToken(accessToken));\n\n  if (!accessToken || tokenCheck.error) {\n    await localStorage.removeItem(\"access_token\");\n    const searchParams = new URLSearchParams(window.location.search);\n    const code = searchParams.get(\"code\");\n\n    if (!code) {\n      const response = await fetch(\"YOUR_SERVERLESS_GET_AUTH_URL_ENDPOINT\");\n      const result = await response.json();\n      const { authUrl } = result;\n      window.location.href = authUrl;\n    } else {\n      return await getToken(code);\n    }\n  }\n  return accessToken;\n};\n\nconst checkToken = async (accessToken) => {\n  const response = await fetch(`https://www.googleapis.com/oauth2/v1/tokeninfo?access_token=${accessToken}`);\n  return await response.json();\n};\n\nexport const getEvents = async () => {\n  if (window.location.href.startsWith(\"http://localhost\")) {\n    return mockData;\n  }\n\n  const token = await getAccessToken();\n  if (token) {\n    removeQuery();\n    const url = `YOUR_GET_EVENTS_API_ENDPOINT/${token}`;\n    const response = await fetch(url);\n    const result = await response.json();\n    return result.events || null;\n  }\n};\n\nconst removeQuery = () => {\n  let newurl;\n  if (window.history.pushState && window.location.pathname) {\n    newurl = `${window.location.protocol}//${window.location.host}${window.location.pathname}`;\n    window.history.pushState(\"\", \"\", newurl);\n  } else {\n    newurl = `${window.location.protocol}//${window.location.host}`;\n    window.history.pushState(\"\", \"\", newurl);\n  }\n};\n\nconst getToken = async (code) => {\n  const encodeCode = encodeURIComponent(code);\n  const response = await fetch(`YOUR_GET_ACCESS_TOKEN_ENDPOINT/${encodeCode}`);\n  const { access_token } = await response.json();\n  if (access_token) {\n    localStorage.setItem(\"access_token\", access_token);\n  }\n  return access_token;\n};\n"],"mappings":"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","ignoreList":[]},"metadata":{},"sourceType":"module"}